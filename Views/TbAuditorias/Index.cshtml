@model IEnumerable<TbAuditorium>

@{
    ViewData["Title"] = "Historial de Auditoría";
}

<div class="text-center mb-4">
    <h1>Historial de Auditoría</h1>
</div>

<div class="d-flex justify-content-center mb-4">
    <button id="loadAuditoria" class="btn btn-secondary me-2">Cargar Auditoría</button>
</div>

<div id="dataTableContainer" style="display: none;">
    <!-- Aquí se cargará la vista parcial de la tabla -->
</div>

@section Scripts {

    <script>
        $(document).ready(function () {

            function cargarTablaAuditoria() {
                $.ajax({
                    url: '@Url.Action("CargarAuditoria", "TbAuditorias")',
                    type: 'GET',
                    success: function (data) {
                        $('#dataTableContainer').html(data);
                        $('#dataTableContainer').fadeIn();

                        // Destruir cualquier DataTable anterior para evitar conflictos
                        if ($.fn.DataTable.isDataTable('#auditoriaTable')) {
                            $('#auditoriaTable').DataTable().destroy();
                        }
                        $('#auditoriaTable').DataTable();
                    },
                    error: function (xhr, status, error) {
                        console.error("Error al cargar auditoría: " + error);
                    }
                });
            }

            $('#loadAuditoria').on('click', function () {
                console.log('Cargando auditoría...');
                cargarTablaAuditoria();
            });
        });
    </script>

}
